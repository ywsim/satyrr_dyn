function [H] = fcn_H_q_reduced(q,L,m,I)

H = zeros(4,4);

  H(1,1)=(I(1) + L(1)^2*m(2) + L(1)^2*m(3) + L(1)^2*m(4) + L(1)^2*m(1))/L(1)^2;
  H(1,2)=L(5)*m(4)*cos(q(3) + q(4) + q(2)) - L(4)*m(4)*sin(q(3) + q(4) + q(2)) + (L(3)*m(3)*...
         cos(q(3) + q(2)))/2 + L(3)*m(4)*cos(q(3) + q(2)) + (L(2)*m(2)*cos(q(2)))/2 + L(2)*m(3)*cos(q(2)) + L(2)*m(4)*cos(q(2));
  H(1,3)=L(5)*m(4)*cos(q(3) + q(4) + q(2)) - L(4)*m(4)*sin(q(3) + q(4) + q(2)) + (L(3)*m(3)*...
         cos(q(3) + q(2)))/2 + L(3)*m(4)*cos(q(3) + q(2));
  H(1,4)=L(5)*m(4)*cos(q(3) + q(4) + q(2)) - L(4)*m(4)*sin(q(3) + q(4) + q(2));
  H(2,1)=L(5)*m(4)*cos(q(3) + q(4) + q(2)) - L(4)*m(4)*sin(q(3) + q(4) + q(2)) + (L(3)*m(3)*...
         cos(q(3) + q(2)))/2 + L(3)*m(4)*cos(q(3) + q(2)) + (L(2)*m(2)*cos(q(2)))/2 + L(2)*m(3)*cos(q(2)) + L(2)*m(4)*cos(q(2));
  H(2,2)=I(2) + I(3) + I(4) + (L(2)^2*m(2))/4 + L(2)^2*m(3) + L(2)^2*m(4) + (L(3)^2*m(3))/4 +...
          L(3)^2*m(4) + L(4)^2*m(4) + L(5)^2*m(4) + 2*L(2)*L(5)*m(4)*cos(q(3) + q(4)) - 2*L(2)*L(4)*m(4)*sin(q(3) +...
          q(4)) + L(2)*L(3)*m(3)*cos(q(3)) + 2*L(2)*L(3)*m(4)*cos(q(3)) + 2*L(3)*L(5)*m(4)*cos(q(4)) - 2*L(3)*L(4)*...
         m(4)*sin(q(4));
  H(2,3)=I(3) + I(4) + (L(3)^2*m(3))/4 + L(3)^2*m(4) + L(4)^2*m(4) + L(5)^2*m(4) + L(2)*L(5)*m(4)*...
         cos(q(3) + q(4)) - L(2)*L(4)*m(4)*sin(q(3) + q(4)) + (L(2)*L(3)*m(3)*cos(q(3)))/2 + L(2)*L(3)*m(4)*cos(q(3)) +...
          2*L(3)*L(5)*m(4)*cos(q(4)) - 2*L(3)*L(4)*m(4)*sin(q(4));
  H(2,4)=I(4) + L(4)^2*m(4) + L(5)^2*m(4) + L(2)*L(5)*m(4)*cos(q(3) + q(4)) - L(2)*L(4)*m(4)*...
         sin(q(3) + q(4)) + L(3)*L(5)*m(4)*cos(q(4)) - L(3)*L(4)*m(4)*sin(q(4));
  H(3,1)=L(5)*m(4)*cos(q(3) + q(4) + q(2)) - L(4)*m(4)*sin(q(3) + q(4) + q(2)) + (L(3)*m(3)*...
         cos(q(3) + q(2)))/2 + L(3)*m(4)*cos(q(3) + q(2));
  H(3,2)=I(3) + I(4) + (L(3)^2*m(3))/4 + L(3)^2*m(4) + L(4)^2*m(4) + L(5)^2*m(4) + L(2)*L(5)*m(4)*...
         cos(q(3) + q(4)) - L(2)*L(4)*m(4)*sin(q(3) + q(4)) + (L(2)*L(3)*m(3)*cos(q(3)))/2 + L(2)*L(3)*m(4)*cos(q(3)) +...
          2*L(3)*L(5)*m(4)*cos(q(4)) - 2*L(3)*L(4)*m(4)*sin(q(4));
  H(3,3)=I(3) + I(4) + (L(3)^2*m(3))/4 + L(3)^2*m(4) + L(4)^2*m(4) + L(5)^2*m(4) + 2*L(3)*L(5)*m(4)*...
         cos(q(4)) - 2*L(3)*L(4)*m(4)*sin(q(4));
  H(3,4)=I(4) + L(4)^2*m(4) + L(5)^2*m(4) + L(3)*L(5)*m(4)*cos(q(4)) - L(3)*L(4)*m(4)*sin(q(4));
  H(4,1)=L(5)*m(4)*cos(q(3) + q(4) + q(2)) - L(4)*m(4)*sin(q(3) + q(4) + q(2));
  H(4,2)=I(4) + L(4)^2*m(4) + L(5)^2*m(4) + L(2)*L(5)*m(4)*cos(q(3) + q(4)) - L(2)*L(4)*m(4)*...
         sin(q(3) + q(4)) + L(3)*L(5)*m(4)*cos(q(4)) - L(3)*L(4)*m(4)*sin(q(4));
  H(4,3)=I(4) + L(4)^2*m(4) + L(5)^2*m(4) + L(3)*L(5)*m(4)*cos(q(4)) - L(3)*L(4)*m(4)*sin(q(4));
  H(4,4)=I(4) + L(4)^2*m(4) + L(5)^2*m(4);

 